## Metabse
SELECT 
    CLINICPERSONNEL.SNAME AS "Dr_Name", 
    COUNT(DISTINCT OPTCHARGEDETAIL.PATID) AS "Total Patient",  
    SUM(OPTCHARGEDETAIL.NETAMT) AS "Total Amount"  
FROM LTHMS.OPTCHARGEDETAIL
LEFT JOIN LTHMS.CLINICPERSONNEL 
    ON OPTCHARGEDETAIL.SID = CLINICPERSONNEL.SID  
    
WHERE {{Date}} 
  AND LOWER(OPTCHARGEDETAIL.RPATTYPE) NOT LIKE '%dhi%'  
  
GROUP BY CLINICPERSONNEL.SNAME  
ORDER BY "Total Amount" DESC 
----------------------------
Sql Developer
SELECT 
    CLINICPERSONNEL.SNAME AS "Dr_Name",  -- Doctor/service name
    COUNT(DISTINCT OPTCHARGEDETAIL.PATID) AS "Total Patient",  -- Unique patients
    SUM(OPTCHARGEDETAIL.NETAMT) AS "Total Amount"  -- Total amount
FROM OPTCHARGEDETAIL
LEFT JOIN CLINICPERSONNEL 
    ON OPTCHARGEDETAIL.SID = CLINICPERSONNEL.SID  -- Joining on SID
WHERE OPTCHARGEDETAIL.BILLDATE BETWEEN TO_DATE('2025-01-01', 'YYYY-MM-DD') 
                                  AND TO_DATE('2025-01-31', 'YYYY-MM-DD')
  AND LOWER(OPTCHARGEDETAIL.RPATTYPE) NOT LIKE '%dhi%'  -- Filter only Not DHI
GROUP BY CLINICPERSONNEL.SNAME  -- Group by doctor/service name
ORDER BY "Total Amount" DESC;  -- Order by total amount in descending order
